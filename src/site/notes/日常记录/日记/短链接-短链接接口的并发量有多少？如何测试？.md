---
{"dg-publish":true,"permalink":"/日常记录/日记/短链接-短链接接口的并发量有多少？如何测试？/"}
---

如果面试官问并发量，那么一般泛指**短链接创建接口**。  
如果问具体 TPS 或者 QPS 的话，我们可以分别回答**短链接创建**和**短链接跳转访问接口**。  

## 短链接项目并发量指的是项目还是具体接口？  
在我看来，很少会存在说项目并发量这个说法，除非项目只对外提供一个接口。为什么这么说？因为我们项目中会存在多种类型的接口，各自差异比较大，所以没办法统一。  
假设我们有个订单服务，其中有两个接口：下单和取消支付功能。下单接口单个执行需要 1 秒的时间，而发起取消订单只需要 50 毫秒。假设下单的 TPS 是 200，那取消订单接口的 QPS 就是 4000。那么请问，项目的并发量是多少呢？  
一般来说，项目并发量泛指**最为核心的一些接口**，拿咱们短链接举例，自然就是短链接新增接口。所以，我们回答并发量就说短链接新增就好。  

## 短链接新增并发量有多少？  
软件架构中，系统设计是一部分，基础设施是一部分。系统设计一般就是看我们的代码和架构是如何运作的，比如代码中运行了先查询缓存 Redis 再查询数据库 MySQL，防止缓存击穿和穿透等设计。基础设施指的是部署的规格，比如 Redis 什么配置、MySQL 什么配置、部署了几台短链接服务以及每台部署机器的配置是多少。  
在和面试官说时，一定要先明确自己的部署配置，比如：  
- 在自己本地电脑上进行的测试，电脑配置 MacBook M2 Max 12C64G。  
- 启动了一个短链接服务。  
- 通过 Jmeter 配置了 40 个线程循环 100 次压测，最终吞吐量 xxx。  
压测了短链接创建的相关指标，可以参考：
**分布式锁：**（600）
![image/Pasted image 20240328190417.png](/img/user/image/Pasted%20image%2020240328190417.png)

**布隆过滤器**：（2400）
![image/Pasted image 20240328190356.png](/img/user/image/Pasted%20image%2020240328190356.png)

## 短链接访问并发量有多少？  
Jmeter 配置同上，40 个线程循环 100 次压测，最终吞吐量大概在 3300 左右。  
![image/Pasted image 20240328190535.png](/img/user/image/Pasted%20image%2020240328190535.png)

我个人感觉这个量是没到瓶颈的，大家也可以压测压测，过程当中挺有意思的。最好性能高一些的电脑进行，指标会大很多。  
正常情况下，咱们短链接访问原始连接，全部走的缓存。最后投递消息队列也是很快的，所以不存在性能瓶颈。我测试了下，单个请求访问大概只有几毫秒。